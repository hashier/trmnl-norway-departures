<!DOCTYPE html>
<html lang="en">

<head>
  <title>Oslo public transport time table</title>
  <link rel="stylesheet" href="https://usetrmnl.com/css/latest/plugins.css">
  <script src="https://usetrmnl.com/js/latest/plugins.js"></script>
</head>

<body class="environment trmnl">
  <!-- <span id="tmp" class"title">Loading tmp...</span> -->
  <script>
    data = { "departures": { "5": { "Ringen via Storo - 1": [{ "schedule": "14:57.00", "expected": "14:58.00", "type": "metro" }, { "schedule": "15:12.00", "expected": "15:12.00", "type": "metro" }], "Vestli - 1": [{ "schedule": "14:53.00", "expected": "14:55.29", "type": "metro" }, { "schedule": "15:08.00", "expected": "15:09.06", "type": "metro" }], "Ringen via T\u00f8yen - 2": [{ "schedule": "15:03.00", "expected": "15:04.06", "type": "metro" }, { "schedule": "15:18.00", "expected": "15:18.00", "type": "metro" }], "Sognsvann via T\u00f8yen - 2": [{ "schedule": "14:59.00", "expected": "15:00.00", "type": "metro" }, { "schedule": "15:14.00", "expected": "15:15.05", "type": "metro" }] }, "17": { "Sinsen-Grefsen st. - D": [{ "schedule": "14:50.00", "expected": "14:55.57", "type": "tram" }, { "schedule": "15:00.00", "expected": "15:02.30", "type": "tram" }, { "schedule": "15:10.00", "expected": "15:11.48", "type": "tram" }, { "schedule": "15:20.00", "expected": "15:20.00", "type": "tram" }], "Rikshospitalet - E": [{ "schedule": "14:58.00", "expected": "14:58.00", "type": "tram" }, { "schedule": "15:08.00", "expected": "15:08.00", "type": "tram" }, { "schedule": "15:18.00", "expected": "15:18.00", "type": "tram" }] } }, "last_updated": "13:48", "minutes_to_fetch": "30", "num_departures": 83, "num_departures-excludes": 64, "name": "Carl Berners plass", "exclude_platforms": "A,B", "fetch_limit": 200 }
    // fetch('https://api.ipify.org?format=json', {mode: 'cors'}).then(response => response.json()).then(data => { console.log(data); document.getElementById("tmp").innerText = data.ip; });
    // fetch('https://europe-north1-trmnl-451212.cloudfunctions.net/function-1?secret=public&minutes_to_fetch=1', {mode: 'cors'}).then(response => response.json()).then(data => { console.log(data); document.getElementById("tmp").innerText = data.ip; }).catch(e => { console.log(`Chris log error: ${e}`); document.getElementById("tmp").innerText = e; });
    // document.getElementById("tmp").innerText = data.name;
  </script>
  <div class="screen">
    <div class="view view--full">
      <div class="layout">

        <div class="columns">

          <div id="output"></div>

          <script>
            document.addEventListener("DOMContentLoaded", function () {
              loopCounts = [];
              loopCounts = [[1, 3, 3, 1], [1, 2, 3, 1], [1, 2, 3, 1]]; // works
              //
              // Uncomment the line below to make the layout break
              //
              loopCounts = [[3, 3, 1], [1, 2, 3, 1], [1, 2, 3, 1]]; // broken
              //
              var addedHTML = ""

              for (let h = 0; h < loopCounts.length; h++) {
                console.log(`Col ${h + 1} runs ${loopCounts[h]} times:`);

                addedHTML += `
          <div class="column">`
                for (let i = 0; i < loopCounts[h].length; i++) {
                  console.log(`Loop ${i + 1} runs ${loopCounts[i]} times:`);
                  addedHTML += `
            <div class="item">
              <div class="meta">
                <span class="index">5</span>
              </div>
              <div class="content">`
                  for (let j = 0; j < loopCounts[h][i]; j++) {
                    console.log(`  Inner loop iteration ${j + 1}`);
                    addedHTML += `
                <span class="title title--small">Ringen via Storo - 5</span>
                <div class="flex gap--small">
                  <span class="label label--small label--underline">9:00</span>
                  <span class="label label--small label--underline">9:10</span>
                  <span class="label label--small label--underline">9:30</span>
                </div>`
                  }
                  addedHTML += `
              </div> <! -- content -->
            </div> <!-- item -->`
                }
                addedHTML += `
          </div> <!-- column -->`
              }
              document.getElementById("output").parentElement.innerHTML += addedHTML;
              document.getElementById("output").parentElement.removeChild(document.getElementById("output"));
            });

          </script>


        </div> <!--  columns -->
      </div> <!-- layout -->

      <div class="title_bar">
        <img class="image" src="https://usetrmnl.com/images/plugins/trmnl--render.svg" />
        <span class="title">Plugin Title</span>
        <span class="instance">Instance Title</span>
      </div>
    </div>
  </div>
</body>

</html>
